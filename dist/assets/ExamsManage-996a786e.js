import{_ as ne,u as se,q as ue,b as de,i,r as j,a as me,c as n,x as re,o as f,d as F,f as e,w as t,F as h,j as $,e as m,g as b,s as z,y as ie,v as _,l as S,t as x,p as ce,h as pe,E as fe}from"./index-23f1c135.js";const q=k=>(ce("data-v-b7a2c4c8"),k=k(),pe(),k),_e=q(()=>m("span",null,"添加试卷",-1)),be=q(()=>m("span",null,"随机组卷",-1)),ve={class:"card-header"},Ve={class:"text item"},ge={class:"text item"},Fe={class:"text item"},xe={class:"text item"},ke={class:"dialog-footer"},ye={class:"dialog-footer"},je={class:"dialog-footer"},Ne={__name:"ExamsManage",setup(k){const L=se(),N=ue("reload"),a=de({info:[],formData:{title:"",subject:void 0,desc:""},randomForm:{subject:void 0,title:"",desc:"",singleNum:0,multipleNum:0,blankNum:0,subjectiveNum:0},scoreForm:{single:0,multiple:0,blank:0,subjective:0}}),B=L.state.subjects;i.get("exam/").then(u=>{a.info=u.data});const v=j(!1),R=()=>{v.value=!1,i.post("exam/",{title:a.formData.title,subject:a.formData.subject,desc:a.formData.desc}).then(u=>{console.log(u),N()}).catch(()=>{_({message:"新建试卷失败！",type:"error"})})},T=me(),A=u=>{T.push({name:"examDetail",params:{examId:u.id}})},G=u=>{console.log("print"),i.get("http://127.0.0.1:8000/api/exam/"+u.id+"/exam-pdf/").then(l=>{window.open(l.data)})},H=u=>{const l=u.url;fe.confirm("确定要删除该试卷吗？","警告",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(()=>{i.delete(l,{baseURL:""}).then(c=>{console.log(c),N()}),_({type:"success",message:"成功删除"})}).catch(()=>{_({type:"info",message:"取消删除"})})},V=j(!1),J=()=>{V.value=!1;let u;i.post("exam/",{title:a.randomForm.title,subject:a.randomForm.subject,desc:a.randomForm.desc}).then(c=>{console.log(c),u=c.data.id,N()}).catch(()=>{_({message:"新建试卷失败！",type:"error"})});const l=[];i.get("choice/random/",{params:{singleNum:a.randomForm.singleNum,multipleNum:a.randomForm.multipleNum,subject:a.randomForm.subject}}).then(c=>{for(let r of c.data)l.push(r);i.get("blank/random/",{params:{num:a.randomForm.blankNum,subject:a.randomForm.subject}}).then(r=>{for(let s of r.data)l.push(s);i.get("subjective/random/",{params:{num:a.randomForm.subjectiveNum,subject:a.randomForm.subject}}).then(s=>{for(let D of s.data)l.push(D)}).finally(()=>{l.forEach(s=>s.exam=u),console.log(l),i.post("exam-question/",l).then(()=>{_({message:"已提交至试卷:"+a.randomForm.title,type:"success"})},()=>{_({message:"提交至试卷失败",type:"error"})})})})})},g=j(!1);let M="";const K=u=>{console.log(u),M=u.url,g.value=!0},w=j(!1),O=()=>{w.value=!0,i.post(M+"set-scores/",a.scoreForm,{baseURL:"",timeout:3e4}).then(u=>{_({message:"已修改分值",type:"success"}),w.value=!1,g.value=!1})};return(u,l)=>{const c=n("Plus"),r=n("el-icon"),s=n("el-button"),D=n("MagicStick"),Q=n("el-col"),W=n("el-row"),X=n("View"),Y=n("EditPen"),Z=n("Printer"),ee=n("Delete"),le=n("el-button-group"),oe=n("el-card"),te=n("el-space"),y=n("el-input"),d=n("el-form-item"),I=n("el-option"),P=n("el-select"),U=n("el-form"),C=n("el-dialog"),p=n("el-input-number"),ae=re("loading");return f(),F("div",null,[e(W,{class:"header",gutter:20},{default:t(()=>[e(Q,null,{default:t(()=>[e(s,{type:"primary",onClick:l[0]||(l[0]=o=>v.value=!0)},{default:t(()=>[e(r,null,{default:t(()=>[e(c)]),_:1}),_e]),_:1}),e(s,{type:"primary",onClick:l[1]||(l[1]=o=>V.value=!0)},{default:t(()=>[e(r,null,{default:t(()=>[e(D)]),_:1}),be]),_:1})]),_:1})]),_:1}),e(te,{warp:"",size:"default"},{default:t(()=>[(f(!0),F(h,null,$(a.info,o=>(f(),S(oe,{class:"box-card",key:o.id,shadow:"hover"},{header:t(()=>[m("div",ve,[m("span",null,x(o.title),1),e(le,null,{default:t(()=>[e(s,{type:"info",size:"default",onClick:E=>A(o)},{default:t(()=>[e(r,null,{default:t(()=>[e(X)]),_:1})]),_:2},1032,["onClick"]),e(s,{type:"info",size:"default",onClick:E=>K(o)},{default:t(()=>[e(r,null,{default:t(()=>[e(Y)]),_:1})]),_:2},1032,["onClick"]),e(s,{type:"info",size:"default",onClick:E=>G(o)},{default:t(()=>[e(r,null,{default:t(()=>[e(Z)]),_:1})]),_:2},1032,["onClick"]),e(s,{type:"info",size:"default",onClick:E=>H(o)},{default:t(()=>[e(r,null,{default:t(()=>[e(ee)]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)])]),default:t(()=>[m("div",Ve,"科目："+x(o.subject_name),1),m("div",ge,"创建者："+x(o.author.username),1),m("div",Fe,"创建时间："+x(o.create_time),1),m("div",xe,"描述："+x(o.desc),1)]),_:2},1024))),128))]),_:1}),e(C,{modelValue:v.value,"onUpdate:modelValue":l[6]||(l[6]=o=>v.value=o),title:"新建试卷",width:"30%","align-center":""},{footer:t(()=>[m("span",ke,[e(s,{onClick:l[5]||(l[5]=o=>v.value=!1)},{default:t(()=>[b("取消")]),_:1}),e(s,{type:"primary",onClick:R},{default:t(()=>[b(" 确认 ")]),_:1})])]),default:t(()=>[e(U,{model:a.formData},{default:t(()=>[e(d,{label:"名称"},{default:t(()=>[e(y,{modelValue:a.formData.title,"onUpdate:modelValue":l[2]||(l[2]=o=>a.formData.title=o),placeholder:"新试卷"},null,8,["modelValue"])]),_:1}),e(d,{label:"科目"},{default:t(()=>[e(P,{modelValue:a.formData.subject,"onUpdate:modelValue":l[3]||(l[3]=o=>a.formData.subject=o)},{default:t(()=>[(f(!0),F(h,null,$(z(B),o=>(f(),S(I,{value:o.value,label:o.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"描述"},{default:t(()=>[e(y,{modelValue:a.formData.desc,"onUpdate:modelValue":l[4]||(l[4]=o=>a.formData.desc=o),rows:2,type:"textarea",placeholder:"请输入描述..."},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(C,{modelValue:V.value,"onUpdate:modelValue":l[15]||(l[15]=o=>V.value=o),title:"随机组卷",width:"30%","align-center":""},{footer:t(()=>[m("span",ye,[e(s,{onClick:l[14]||(l[14]=o=>V.value=!1)},{default:t(()=>[b("取消")]),_:1}),e(s,{type:"primary",onClick:J},{default:t(()=>[b(" 确认 ")]),_:1})])]),default:t(()=>[e(U,{model:a.randomForm,"label-width":"100px"},{default:t(()=>[e(d,{label:"科目"},{default:t(()=>[e(P,{modelValue:a.randomForm.subject,"onUpdate:modelValue":l[7]||(l[7]=o=>a.randomForm.subject=o)},{default:t(()=>[(f(!0),F(h,null,$(z(B),o=>(f(),S(I,{value:o.value,label:o.label},null,8,["value","label"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"试卷名称"},{default:t(()=>[e(y,{modelValue:a.randomForm.title,"onUpdate:modelValue":l[8]||(l[8]=o=>a.randomForm.title=o),placeholder:"新试卷"},null,8,["modelValue"])]),_:1}),e(d,{label:"描述"},{default:t(()=>[e(y,{modelValue:a.randomForm.desc,"onUpdate:modelValue":l[9]||(l[9]=o=>a.randomForm.desc=o),rows:2,type:"textarea",placeholder:"请输入描述..."},null,8,["modelValue"])]),_:1}),e(d,{label:"单选题数量"},{default:t(()=>[e(p,{modelValue:a.randomForm.singleNum,"onUpdate:modelValue":l[10]||(l[10]=o=>a.randomForm.singleNum=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"多选题数量"},{default:t(()=>[e(p,{modelValue:a.randomForm.multipleNum,"onUpdate:modelValue":l[11]||(l[11]=o=>a.randomForm.multipleNum=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"填空题数量"},{default:t(()=>[e(p,{modelValue:a.randomForm.blankNum,"onUpdate:modelValue":l[12]||(l[12]=o=>a.randomForm.blankNum=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"主观题数量"},{default:t(()=>[e(p,{modelValue:a.randomForm.subjectiveNum,"onUpdate:modelValue":l[13]||(l[13]=o=>a.randomForm.subjectiveNum=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(C,{modelValue:g.value,"onUpdate:modelValue":l[21]||(l[21]=o=>g.value=o),title:"修改分值",width:"30%","align-center":""},{footer:t(()=>[m("span",je,[e(s,{onClick:l[20]||(l[20]=o=>g.value=!1)},{default:t(()=>[b("取消")]),_:1}),e(s,{type:"primary",onClick:O},{default:t(()=>[b(" 确认 ")]),_:1})])]),default:t(()=>[ie((f(),F("div",null,[e(U,null,{default:t(()=>[e(d,{label:"单选题分值"},{default:t(()=>[e(p,{modelValue:a.scoreForm.single,"onUpdate:modelValue":l[16]||(l[16]=o=>a.scoreForm.single=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"多选题分值"},{default:t(()=>[e(p,{modelValue:a.scoreForm.multiple,"onUpdate:modelValue":l[17]||(l[17]=o=>a.scoreForm.multiple=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"填空题分值"},{default:t(()=>[e(p,{modelValue:a.scoreForm.blank,"onUpdate:modelValue":l[18]||(l[18]=o=>a.scoreForm.blank=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"主观题分值"},{default:t(()=>[e(p,{modelValue:a.scoreForm.subjective,"onUpdate:modelValue":l[19]||(l[19]=o=>a.scoreForm.subjective=o)},null,8,["modelValue"])]),_:1})]),_:1})])),[[ae,w.value]])]),_:1},8,["modelValue"])])}}},De=ne(Ne,[["__scopeId","data-v-b7a2c4c8"]]);export{De as default};
