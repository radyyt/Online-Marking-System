import{_ as G,b as H,r as V,i as f,c as r,o,d as c,f as t,w as s,F as v,j as w,e as i,t as p,m as F,l as y,g,s as J,v as E,A as K,p as O,h as P}from"./index-23f1c135.js";const x=I=>(O("data-v-8ad399ce"),I=I(),P(),I),W={class:"question-area"},X={key:0},Y=x(()=>i("h3",null,"题目：",-1)),Z={class:"text"},$=x(()=>i("h3",null,"正确答案：",-1)),ee={class:"text"},te={key:1,class:"text"},se=x(()=>i("h3",null,"学生答案：",-1)),le={class:"text"},ne={key:1,class:"text"},ae={class:"mark-area"},oe=x(()=>i("h2",null,"分值：",-1)),re=x(()=>i("h2",null,"得分：",-1)),ue={__name:"Mark",setup(I){const e=H({classes:[],exams:[],questionId:{list:[],currentIndex:0},filteredExams:[],selectForm:{classId:void 0,examId:void 0},selectedExam:null,answers:{list:[],currentIndex:0}}),l=V(null);f.get("class/").then(a=>{e.classes=a.data}),f.get("class-exam/").then(a=>{e.exams=a.data});const A=()=>{e.selectForm.examId=void 0,e.filteredExams=e.exams.filter(a=>a.classes.id===e.selectForm.classId)},z=()=>{e.selectedExam=e.filteredExams.find(d=>d.exam.id==e.selectForm.examId).exam;const a=e.selectedExam.id;f.get("exam-question/",{params:{exam:a}}).then(d=>{e.questionId.list=d.data.filter(u=>u.type==2||u.type==3).map(u=>({id:u.question_id,score:u.score})),f.get("answer/",{params:{question_id:e.questionId.list[0].id}}).then(u=>{e.answers.list=u.data,l.value=u.data[0],l.value.full_score=e.questionId.list[0].score})})},q=V(0),B=()=>{e.answers.list=[],e.answers.currentIndex=0,e.questionId.currentIndex=e.questionId.currentIndex-1,f.get("answer/",{params:{question_id:e.questionId.list[e.questionId.currentIndex].id}}).then(a=>{e.answers.list=a.data,l.value=a.data[0],l.value.full_score=e.questionId.list[e.questionId.currentIndex].score})},M=()=>{e.answers.list=[],e.answers.currentIndex=0,e.questionId.currentIndex=e.questionId.currentIndex+1,f.get("answer/",{params:{question_id:e.questionId.list[e.questionId.currentIndex].id}}).then(a=>{e.answers.list=a.data,console.log(e.answers.list),l.value=a.data[0],l.value.full_score=e.questionId.list[e.questionId.currentIndex].score})},N=()=>{e.answers.currentIndex=e.answers.currentIndex-1,l.value=e.answers.list[e.answers.currentIndex],l.value.full_score=e.questionId.list[e.questionId.currentIndex].score},R=()=>{e.answers.currentIndex=e.answers.currentIndex+1,l.value=e.answers.list[e.answers.currentIndex],l.value.full_score=e.questionId.list[e.questionId.currentIndex].score},S=()=>{let a=l.value.url;f.patch(a,{score:q.value},{baseURL:""}).then(()=>{E({message:"计分成功！",type:"success"})}).catch(()=>{E({message:"计分失败！",type:"error"})})};return(a,d)=>{const u=r("el-option"),k=r("el-select"),C=r("el-form-item"),U=r("el-form"),_=r("el-col"),m=r("el-row"),Q=r("el-scrollbar"),j=r("el-input-number"),h=r("el-button"),L=r("ArrowRight"),D=r("el-icon"),T=r("el-button-group");return o(),c("div",null,[t(m,{gutter:0},{default:s(()=>[t(_,{span:24,offset:0},{default:s(()=>[t(U,{model:e.selectForm,ref:"selectFormRef",inline:!0,size:"default"},{default:s(()=>[t(C,null,{default:s(()=>[t(k,{modelValue:e.selectForm.classId,"onUpdate:modelValue":d[0]||(d[0]=n=>e.selectForm.classId=n),placeholder:"请选择班级",clearable:"",filterable:"",onChange:A},{default:s(()=>[(o(!0),c(v,null,w(e.classes,n=>(o(),y(u,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(C,null,{default:s(()=>[t(k,{modelValue:e.selectForm.examId,"onUpdate:modelValue":d[1]||(d[1]=n=>e.selectForm.examId=n),placeholder:"请选择试卷",clearable:"",filterable:"",onChange:z},{default:s(()=>[(o(!0),c(v,null,w(e.filteredExams,n=>(o(),y(u,{key:n.exam.id,label:n.exam.title,value:n.exam.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),t(m,null,{default:s(()=>[i("div",W,[t(Q,{"max-height":"50vh"},{default:s(()=>[l.value!=null?(o(),c("div",X,[Y,t(m,null,{default:s(()=>[i("div",Z,p(l.value.question_body),1)]),_:1}),$,t(m,null,{default:s(()=>[t(_,null,{default:s(()=>[l.value.question_type==2?(o(!0),c(v,{key:0},w(l.value.correct.split(";"),(n,b)=>(o(),c("p",ee," 空"+p(b+1)+" : "+p(n),1))),256)):(o(),c("p",te,p(l.value.correct),1))]),_:1})]),_:1}),se,t(m,null,{default:s(()=>[t(_,null,{default:s(()=>[l.value.question_type==2?(o(!0),c(v,{key:0},w(l.value.context.split(";"),(n,b)=>(o(),c("p",le," 空"+p(b+1)+" : "+p(n),1))),256)):(o(),c("p",ne,p(l.value.context),1))]),_:1})]),_:1})])):F("",!0)]),_:1})]),i("div",ae,[t(m,null,{default:s(()=>[t(_,{span:2},{default:s(()=>[oe]),_:1}),l.value!=null?(o(),y(_,{key:0,span:5},{default:s(()=>[i("h2",null,p(l.value.full_score),1)]),_:1})):F("",!0)]),_:1}),t(m,null,{default:s(()=>[t(_,{span:2},{default:s(()=>[re]),_:1}),t(_,{span:5},{default:s(()=>[t(j,{modelValue:q.value,"onUpdate:modelValue":d[2]||(d[2]=n=>q.value=n),min:0,size:"large",onChange:S},null,8,["modelValue"])]),_:1}),t(_,{span:5},{default:s(()=>[t(h,{type:"primary",size:"large",onClick:N,disabled:e.answers.currentIndex==0},{default:s(()=>[g("上一份")]),_:1},8,["disabled"]),t(h,{type:"primary",size:"large",onClick:R,disabled:e.answers.currentIndex==e.answers.list.length-1},{default:s(()=>[g("下一份")]),_:1},8,["disabled"])]),_:1})]),_:1})])]),_:1}),t(m,{justify:"center"},{default:s(()=>[t(T,null,{default:s(()=>[t(h,{type:"primary",icon:J(K),onClick:B,disabled:e.questionId.currentIndex==0},{default:s(()=>[g("上一题")]),_:1},8,["icon","disabled"]),t(h,{type:"primary",onClick:M,disabled:e.questionId.currentIndex==e.questionId.list.length-1},{default:s(()=>[g(" 下一题"),t(D,{class:"el-icon--right"},{default:s(()=>[t(L)]),_:1})]),_:1},8,["disabled"])]),_:1})]),_:1})])}}},ce=G(ue,[["__scopeId","data-v-8ad399ce"]]);export{ce as default};
