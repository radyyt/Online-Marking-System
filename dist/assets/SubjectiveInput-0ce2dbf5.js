import{u as C,r as R,b as D,c as r,o as d,d as v,f as o,w as l,F as S,j as h,s as B,l as N,g as p,i as j,v as b}from"./index-23f1c135.js";const I={__name:"SubjectiveInput",props:["question"],emits:["cancelDialog"],setup(g,{emit:F}){const f=g,w=C().state.subjects,i=R(null),e=D({questionUrl:"",image:{},subjectiveForm:{desc:"",subject:0,answer:""},subjectiveFormRules:{desc:[{required:!0,message:"请输入题目",trigger:"blur"}],answer:[{required:!0,message:"请输入答案",trigger:"blur"}]}}),y=t=>{e.image=t,console.log(t),console.log(e.image)},V=()=>{let t=new FormData;t.append("body",e.subjectiveForm.desc),t.append("correct_answer",e.subjectiveForm.answer),t.append("subject",e.subjectiveForm.subject),JSON.stringify(e.image)!=="{}"&&t.append("image",e.image.raw),i.value.validate(s=>{if(s){const c=e.questionUrl;c!=""?j.put(c,t,{headers:{"Content-Type":"multipart/form-data"},baseURL:""}).then(n=>{console.log(n),F("cancelDialog"),window.location.reload()},()=>{b({message:"题目修改失败！",type:"error"})}):j.post("subjective/",t).then(n=>{b({message:"题目录入成功！",type:"success"})},n=>{b({message:"题目录入失败！",type:"error"})})}})},k=t=>{t.resetFields()},x=t=>{const s=e.subjectiveForm;s.desc=t.body,s.subject=t.subject,s.answer=t.correct_answer,e.questionUrl=t.url};return f.question!=null&&x(f.question),(t,s)=>{const c=r("el-option"),n=r("el-select"),u=r("el-form-item"),_=r("el-input"),m=r("el-button"),U=r("el-upload"),q=r("el-form");return d(),v("div",null,[o(q,{model:e.subjectiveForm,rules:e.subjectiveFormRules,ref_key:"subjectiveFormRef",ref:i,"label-width":"100px","label-position":"left","status-icon":"","hide-required-asterisk":""},{default:l(()=>[o(u,{label:"科目"},{default:l(()=>[o(n,{modelValue:e.subjectiveForm.subject,"onUpdate:modelValue":s[0]||(s[0]=a=>e.subjectiveForm.subject=a),placeholder:"选择科目",filterable:""},{default:l(()=>[(d(!0),v(S,null,h(B(w),a=>(d(),N(c,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(u,{label:"题目",prop:"desc"},{default:l(()=>[o(_,{modelValue:e.subjectiveForm.desc,"onUpdate:modelValue":s[1]||(s[1]=a=>e.subjectiveForm.desc=a),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1}),o(u,{label:"答案",prop:"answer"},{default:l(()=>[o(_,{modelValue:e.subjectiveForm.answer,"onUpdate:modelValue":s[2]||(s[2]=a=>e.subjectiveForm.answer=a),type:"textarea",autosize:""},null,8,["modelValue"])]),_:1}),o(u,{label:"配图",prop:"pic"},{default:l(()=>[o(U,{action:"https://run.mocky.io/v3/9d059bf9-4660-45f2-925d-ce80ad6c4d15","on-change":y,"auto-upload":!1},{default:l(()=>[o(m,{type:"primary"},{default:l(()=>[p("点击此处上传图片")]),_:1})]),_:1})]),_:1}),o(u,null,{default:l(()=>[o(m,{type:"success",onClick:V},{default:l(()=>[p("提 交")]),_:1}),o(m,{type:"danger",onClick:s[3]||(s[3]=a=>k(i.value))},{default:l(()=>[p("重 置")]),_:1})]),_:1})]),_:1},8,["model","rules"])])}}};export{I as _};
